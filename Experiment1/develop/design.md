# 1.2.1 搜索引擎架构设计

如何构建一个搜索引擎，从专业名称来看，叫做**信息检索**，在《信息检索导论》一书中，这个概念定义如下：

> 信息检索是从大规模非结构化数据（通常是文本）的集合（通常保存在计算机上）中找出满足用户信息需求的资料（通常是文档）的过程。

由于我们的目标文档全是技术博客，所以我们构建的搜索引擎是针对技术博客领域的垂直搜索引擎：

![此处输入图片的描述](https://doc.shiyanlou.com/document-uid600404labid7463timestamp1543214109356.png/wm)

根据上面图示可以很清晰地看出一个搜索系统的必要模块组件，下面我将以一个信息检索小例子来带大家根据上图走一遍流程。

数据文档暂且不必从网络上爬取，让我们根据以下的三篇文档来了解下文档检索的一些概念：

- 文档1：举杯邀明月，对影成三人。
- 文档2：君不见黄河之水天上来，奔流到海不复回。
- 文档3：明月几时有，把酒问青天。不知天上宫阙，今夕是何年。

这三句诗大家自然是耳熟能详，假设我们需要从这些文档中搜索出**明月**和**天上**，因为这仅仅是三条简单的诗词文档并且我们非常熟悉，所以可以很迅速的得出文档三包含这两个关键词，从第一行看到最后一行，从第一句看到最后一句，我们就能得出答案，这种方法被称之为线性扫描法。

但是这种线性扫描法局限性太多，让我们看看一种更好的方案，词项-文档(term-doc)的关联矩阵：

| 词汇 | 文档1 | 文档2 | 文档3 |
| ---- | ----- | ----- | ----- |
| 明月 | 1     | 0     | 1     |
| 天上 | 0     | 1     | 1     |

词项—文档关联矩阵，其中每行表示一个词，每列表示一个文档，当词`t`在文档`d`中存在时，矩阵元素`(t，d)`的值为1，否则为0，这样就得到一个布尔值构成的**词项-文档关联矩阵**，在该模型下，每篇文档就可以被看成是一系列词的集合。

有了**词项-文档关联矩阵**，就可以很轻松地使用布尔检索模型进行查询。

> 布尔检索模型接受布尔表达式查询，即通过AND、OR及NOT等逻辑操作符将词项连接起来的查询。

观察上面的**词项-文档关联矩阵**，可以看到：

- **明月**词汇：(1,0,1)
- **天上**词汇：(0,1,1)

然后对这两个查询词进行基于位的与操作，`明月 AND 天上 => (1,0,1) AND (0,1,1) = (0,0,1)`，显而易见，文档三就是我们要的结果。

当文档数量增大，词项-文档(term-doc)的关联矩阵高度稀疏，矩阵中的大部分元素为0，此时只记录原始矩阵中1的位置的表示方法比词项-文档(term-doc)矩阵效果更好。

沿着这个方向思考解决方案，引出的就是信息检索中的一个核心概念——倒排索引（inverted index）。